(function () {
  var global = tinymce.util.Tools.resolve('tinymce.PluginManager')
  tinymce.PluginManager.add('custom', function (editor, url) {
    // 注册附件按钮
    editor.ui.registry.addButton('attachment', {
      text: editor.getParam('attachment_text', '附件'),
      tooltip: '选择附件',
      onAction: function () {
        editor.fire('attachment')
      }
    });

    // 注册上传按钮
    editor.ui.registry.addButton('upload-image', {
      text: editor.getParam('upload_image_text', '上传'),
      tooltip: '上传图片',
      onAction: function () {
        editor.fire('upload-image')
      }
    });
    // 注册转换图片按钮
    editor.ui.registry.addButton('transform-image', {
      text: editor.getParam('transform_image_text', '转换图片'),
      tooltip: '将编辑器里的外部图片上传至服务器',
      onAction: function () {
        editor.fire('transform-image')
      }
    });

    // Either return plugin metadata or do not return
    return {
      getMetadata: function () {
        return {
          //插件名和链接会显示在“帮助”→“插件”→“已安装的插件”中
          name: "custom",//插件名称
          url: ''
        };
      }
    }
  })
})()
